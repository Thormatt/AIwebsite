<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI ROI Calculator - Thor AI Advisory</title>
    <meta name="description" content="Calculate realistic ROI projections for your AI implementation with actual costs and timelines">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Crimson+Text:ital@0;1&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../styles.css">
    <style>
        .calculator-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .calculator-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .calculator-header h1 {
            font-size: 2.5rem;
            color: #2c3e50;
            margin-bottom: 1rem;
        }

        .calculator-header p {
            font-size: 1.125rem;
            color: #6b7280;
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 3rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 768px) {
            .calculator-grid {
                grid-template-columns: 1fr;
            }
        }

        .input-section {
            background: #ffffff;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            padding: 2rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            transition: box-shadow 0.2s;
        }

        .input-section:hover {
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.08);
        }

        .input-section h2 {
            font-size: 1.375rem;
            color: #1f2937;
            margin-bottom: 1.75rem;
            padding-bottom: 1rem;
            border-bottom: 2px solid #f3f4f6;
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .input-section h2 svg {
            color: #d4a574;
        }

        .input-group {
            margin-bottom: 1.5rem;
        }

        .input-group label {
            display: block;
            font-weight: 500;
            margin-bottom: 0.5rem;
            color: #4b5563;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 0.875rem;
            border: 1.5px solid #e5e7eb;
            border-radius: 8px;
            font-size: 1rem;
            background: #fafafa;
            transition: all 0.2s;
        }

        .input-group input:hover,
        .input-group select:hover {
            border-color: #d1d5db;
            background: #ffffff;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #d4a574;
            background: #ffffff;
            box-shadow: 0 0 0 3px rgba(212, 165, 116, 0.1);
        }

        .input-helper {
            font-size: 0.875rem;
            color: #6b7280;
            margin-top: 0.25rem;
        }

        .results-section {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            border-radius: 16px;
            padding: 2.5rem;
            margin-top: 2rem;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .results-section h2 {
            font-size: 1.875rem;
            margin-bottom: 2rem;
        }

        .metric-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 2rem;
            margin-bottom: 2rem;
        }

        .metric {
            text-align: center;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            transition: all 0.3s;
        }

        .metric:hover {
            background: rgba(255, 255, 255, 0.1);
            transform: translateY(-2px);
        }

        .metric-value {
            font-size: 2.5rem;
            font-weight: 600;
            color: #d4a574;
        }

        .metric-label {
            font-size: 0.875rem;
            opacity: 0.9;
            margin-top: 0.5rem;
        }

        .chart-container {
            background: rgba(255, 255, 255, 0.08);
            border-radius: 12px;
            padding: 2rem;
            margin-top: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .timeline-chart {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            height: 200px;
            padding: 1rem 0;
        }

        .timeline-bar {
            flex: 1;
            display: flex;
            flex-direction: column;
            align-items: center;
            margin: 0 0.5rem;
        }

        .bar {
            width: 100%;
            background: #d4a574;
            border-radius: 6px 6px 0 0;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            min-height: 10px;
            box-shadow: 0 -2px 8px rgba(212, 165, 116, 0.3);
        }

        .bar-label {
            margin-top: 0.5rem;
            font-size: 0.875rem;
        }

        .warning-box {
            background: rgba(217, 119, 6, 0.12);
            border: 1px solid rgba(217, 119, 6, 0.4);
            border-radius: 10px;
            padding: 1.25rem;
            margin-top: 1.5rem;
            border-left: 4px solid #f59e0b;
        }

        .warning-box p {
            color: #fbbf24;
            font-size: 0.9375rem;
            line-height: 1.6;
        }

        .calculate-btn {
            width: 100%;
            padding: 1.125rem;
            background: linear-gradient(135deg, #d4a574 0%, #c19560 100%);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.125rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 12px rgba(212, 165, 116, 0.25);
        }

        .calculate-btn:hover {
            background: linear-gradient(135deg, #c19560 0%, #a8824e 100%);
            box-shadow: 0 6px 20px rgba(212, 165, 116, 0.35);
            transform: translateY(-1px);
        }

        .calculate-btn:active {
            transform: translateY(0);
        }

        .back-link {
            display: inline-flex;
            align-items: center;
            color: #d4a574;
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 2rem;
            transition: color 0.2s;
        }

        .back-link:hover {
            color: #b8935f;
        }
    </style>
</head>
<body>
    <div class="calculator-container">
        <a href="../tools.html" class="back-link">‚Üê Back to Tools</a>

        <div class="calculator-header">
            <h1>AI ROI Calculator</h1>
            <p>Get realistic projections based on your specific use case and implementation approach</p>
        </div>

        <div class="calculator-grid">
            <!-- Input Section -->
            <div class="input-section">
                <h2 style="display: flex; align-items: center; gap: 0.75rem;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="4" y1="21" x2="4" y2="14"></line>
                        <line x1="4" y1="10" x2="4" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="12"></line>
                        <line x1="12" y1="8" x2="12" y2="3"></line>
                        <line x1="20" y1="21" x2="20" y2="16"></line>
                        <line x1="20" y1="12" x2="20" y2="3"></line>
                        <line x1="1" y1="14" x2="7" y2="14"></line>
                        <line x1="9" y1="8" x2="15" y2="8"></line>
                        <line x1="17" y1="16" x2="23" y2="16"></line>
                    </svg>
                    Project Parameters
                </h2>

                <div class="input-group">
                    <label for="use-case">Use Case Type</label>
                    <select id="use-case">
                        <option value="customer-service">Customer Service Automation</option>
                        <option value="content-generation">Content Generation</option>
                        <option value="data-analysis">Data Analysis & Insights</option>
                        <option value="process-automation">Process Automation</option>
                        <option value="predictive-analytics">Predictive Analytics</option>
                        <option value="custom">Custom Implementation</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="company-size">Company Size (Employees)</label>
                    <input type="number" id="company-size" value="500" min="1">
                    <span class="input-helper">Total number of employees</span>
                </div>

                <div class="input-group">
                    <label for="affected-employees">Affected Employees</label>
                    <input type="number" id="affected-employees" value="50" min="1">
                    <span class="input-helper">Employees who will use the AI system</span>
                </div>

                <div class="input-group">
                    <label for="average-salary">Average Annual Salary ($)</label>
                    <input type="number" id="average-salary" value="75000" min="0">
                    <span class="input-helper">Average salary of affected employees</span>
                </div>

                <div class="input-group">
                    <label for="implementation-type">Implementation Approach</label>
                    <select id="implementation-type">
                        <option value="saas">SaaS Solution (Quick)</option>
                        <option value="hybrid">Hybrid (SaaS + Customization)</option>
                        <option value="custom">Full Custom Development</option>
                    </select>
                </div>

                <!-- Monthly volume input temporarily removed - being redesigned for usage-based cost modeling -->
            </div>

            <!-- Cost Inputs Section -->
            <div class="input-section">
                <h2 style="display: flex; align-items: center; gap: 0.75rem;">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="12" y1="1" x2="12" y2="23"></line>
                        <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
                    </svg>
                    Cost Estimates
                </h2>

                <div class="input-group">
                    <label for="initial-investment">Initial Investment ($)</label>
                    <input type="number" id="initial-investment" value="50000" min="0">
                    <span class="input-helper">Setup, integration, initial licenses</span>
                </div>

                <div class="input-group">
                    <label for="monthly-cost">Monthly Operating Cost ($)</label>
                    <input type="number" id="monthly-cost" value="5000" min="0">
                    <span class="input-helper">Licenses, API costs, maintenance</span>
                </div>

                <div class="input-group">
                    <label for="training-cost">Training & Change Management ($)</label>
                    <input type="number" id="training-cost" value="15000" min="0">
                    <span class="input-helper">Employee training and transition costs</span>
                </div>

                <div class="input-group">
                    <label for="efficiency-gain">Expected Efficiency Gain (%)</label>
                    <input type="number" id="efficiency-gain" value="20" min="0" max="100">
                    <span class="input-helper">Time saved on affected tasks</span>
                </div>

                <div class="input-group">
                    <label for="realization-rate">Realization Rate (%)</label>
                    <input type="number" id="realization-rate" value="60" min="0" max="100">
                    <span class="input-helper">% of time saved that converts to actual value (60-70% typical)</span>
                </div>

                <div class="input-group">
                    <label for="ramp-time">Ramp-up Time (months)</label>
                    <input type="number" id="ramp-time" value="6" min="1" max="24">
                    <span class="input-helper">Time to reach full efficiency</span>
                </div>

                <button class="calculate-btn" onclick="calculateROI()">Calculate ROI</button>
            </div>
        </div>

        <!-- Results Section -->
        <div class="results-section" id="results" style="display: none;">
            <h2 style="display: flex; align-items: center; gap: 0.75rem;">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                    <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                    <polyline points="17 6 23 6 23 12"></polyline>
                </svg>
                ROI Analysis
            </h2>

            <div class="metric-grid">
                <div class="metric">
                    <div class="metric-value" id="breakeven">--</div>
                    <div class="metric-label">Months to Break-Even</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="roi-1year">--</div>
                    <div class="metric-label">1-Year ROI</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="roi-3year">--</div>
                    <div class="metric-label">3-Year ROI</div>
                </div>
                <div class="metric">
                    <div class="metric-value" id="monthly-savings">--</div>
                    <div class="metric-label">Monthly Savings (Peak)</div>
                </div>
            </div>

            <div class="chart-container">
                <h3 style="margin-bottom: 1rem;">Cumulative Value Over Time</h3>
                <div class="timeline-chart" id="timeline-chart">
                    <div class="timeline-bar">
                        <div class="bar" id="bar-6mo"></div>
                        <div class="bar-label">6 mo</div>
                    </div>
                    <div class="timeline-bar">
                        <div class="bar" id="bar-12mo"></div>
                        <div class="bar-label">12 mo</div>
                    </div>
                    <div class="timeline-bar">
                        <div class="bar" id="bar-18mo"></div>
                        <div class="bar-label">18 mo</div>
                    </div>
                    <div class="timeline-bar">
                        <div class="bar" id="bar-24mo"></div>
                        <div class="bar-label">24 mo</div>
                    </div>
                    <div class="timeline-bar">
                        <div class="bar" id="bar-36mo"></div>
                        <div class="bar-label">36 mo</div>
                    </div>
                </div>
            </div>

            <div class="warning-box">
                <p><strong>Reality Check:</strong> These projections assume perfect execution. In practice, expect 20-40% variance due to adoption challenges, technical issues, and unforeseen costs. AI projects typically take 50% longer than planned and cost 30% more than budgeted.</p>
            </div>

            <div style="margin-top: 2rem; padding: 2rem; background: rgba(255,255,255,0.1); border-radius: 12px; border-left: 4px solid #d4a574;">
                <h3 style="margin-bottom: 1rem; color: white;">How We Calculate Your ROI</h3>
                <p style="color: rgba(255,255,255,0.9); line-height: 1.8; margin-bottom: 1rem;">
                    Our calculator estimates your <strong>annual cost savings</strong> based on three key inputs:
                </p>
                <ul style="color: rgba(255,255,255,0.9); line-height: 2; margin-left: 1.5rem;">
                    <li><strong>Efficiency Gain (%)</strong> ‚Äì Time saved on affected tasks per employee</li>
                    <li><strong>Affected Employees</strong> ‚Äì Number of people performing these tasks</li>
                    <li><strong>Average Salary</strong> ‚Äì Applied with 1.3x burden rate (benefits + overhead)</li>
                </ul>
                <p style="color: rgba(255,255,255,0.8); line-height: 1.8; margin-top: 1rem; font-size: 0.9rem;">
                    <strong>Assumptions:</strong> We model a gradual ramp-up over your specified timeline and assume saved time is repurposed for work of equal or greater value.
                </p>
                <p style="color: rgba(255,255,255,0.8); line-height: 1.8; margin-top: 1rem; font-size: 0.9rem;">
                    <strong>What's not included:</strong> This model focuses on direct cost savings. It does not yet account for potential gains from improved quality, increased throughput, or new revenue opportunities‚Äîwhich are often more significant than efficiency savings alone.
                </p>
                <p style="color: rgba(16, 185, 129, 0.9); line-height: 1.6; margin-top: 1.5rem; font-size: 0.875rem; display: flex; align-items: center; gap: 0.5rem;">
                    üîí <strong>Privacy:</strong> All calculations run in your browser. We don't store or transmit your inputs.
                </p>
            </div>

            <!-- Premium Features (Locked) -->
            <div style="margin-top: 3rem; padding: 0; position: relative;">
                <h2 style="color: white; margin-bottom: 2rem; text-align: center;">Premium Analysis (Advisory Session Access)</h2>

                <!-- NPV/IRR/Payback Section -->
                <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(212, 165, 116, 0.3); border-radius: 12px; padding: 2rem; margin-bottom: 2rem; position: relative; filter: blur(2px); pointer-events: none;">
                    <h3 style="color: white; margin-bottom: 1rem;">Finance-Grade Metrics</h3>
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 2rem;">
                        <div>
                            <div style="font-size: 2rem; color: #d4a574; font-weight: 600;">$XXX,XXX</div>
                            <div style="color: rgba(255,255,255,0.8); font-size: 0.875rem;">Net Present Value</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; color: #d4a574; font-weight: 600;">XX%</div>
                            <div style="color: rgba(255,255,255,0.8); font-size: 0.875rem;">Internal Rate of Return</div>
                        </div>
                        <div>
                            <div style="font-size: 2rem; color: #d4a574; font-weight: 600;">XX mo</div>
                            <div style="color: rgba(255,255,255,0.8); font-size: 0.875rem;">Payback Period</div>
                        </div>
                    </div>
                </div>
                <div style="position: absolute; top: 100px; left: 50%; transform: translateX(-50%); z-index: 10; text-align: center;">
                    <div style="background: #2c3e50; padding: 1.5rem 2rem; border-radius: 12px; border: 2px solid #d4a574;">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="#d4a574" stroke-width="2" style="margin-bottom: 1rem;">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>
                        <h3 style="color: white; margin-bottom: 0.5rem;">CFO-Grade Financial Analysis</h3>
                        <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin-bottom: 1rem;">NPV with discount rate, IRR vs. hurdle rate, true payback period</p>
                    </div>
                </div>

                <!-- Scenario Analysis Section -->
                <div style="position: relative; margin-top: 4rem; margin-bottom: 3rem;">
                    <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(212, 165, 116, 0.3); border-radius: 12px; padding: 2rem; filter: blur(2px); pointer-events: none;">
                        <h3 style="color: white; margin-bottom: 1rem;">Scenario Analysis</h3>
                        <table style="width: 100%; color: white;">
                            <tr style="border-bottom: 1px solid rgba(255,255,255,0.2);">
                                <th style="text-align: left; padding: 0.5rem;">Metric</th>
                                <th style="padding: 0.5rem;">Conservative</th>
                                <th style="padding: 0.5rem;">Base</th>
                                <th style="padding: 0.5rem;">Aggressive</th>
                            </tr>
                            <tr><td style="padding: 0.5rem;">1-Year ROI</td><td>XX%</td><td>XX%</td><td>XX%</td></tr>
                            <tr><td style="padding: 0.5rem;">3-Year ROI</td><td>XXX%</td><td>XXX%</td><td>XXX%</td></tr>
                            <tr><td style="padding: 0.5rem;">Break-even</td><td>XX mo</td><td>XX mo</td><td>XX mo</td></tr>
                        </table>
                    </div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10; text-align: center; width: 90%; max-width: 500px;">
                        <div style="background: #2c3e50; padding: 1.5rem 2rem; border-radius: 12px; border: 2px solid #d4a574; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
                            <h3 style="color: white; margin-bottom: 0.5rem;">Range-Based Projections</h3>
                            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin: 0;">Conservative/Base/Aggressive scenarios with sensitivity analysis</p>
                        </div>
                    </div>
                </div>

                <!-- Usage-Based Costing Section -->
                <div style="position: relative; margin-top: 3rem; margin-bottom: 3rem;">
                    <div style="background: rgba(255,255,255,0.05); border: 2px solid rgba(212, 165, 116, 0.3); border-radius: 12px; padding: 2rem; filter: blur(2px); pointer-events: none;">
                        <h3 style="color: white; margin-bottom: 1rem;">AI-Specific Cost Modeling</h3>
                        <div style="color: rgba(255,255,255,0.8);">
                            <p>‚Ä¢ LLM token costs (input/output pricing, cache hit rates)</p>
                            <p>‚Ä¢ Embedding & vector DB costs</p>
                            <p>‚Ä¢ Quality improvement benefits (error reduction, revenue lift)</p>
                            <p>‚Ä¢ Compliance costs (HIPAA, SOC2, human review)</p>
                        </div>
                    </div>
                    <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 10; text-align: center; width: 90%; max-width: 500px;">
                        <div style="background: #2c3e50; padding: 1.5rem 2rem; border-radius: 12px; border: 2px solid #d4a574; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
                            <h3 style="color: white; margin-bottom: 0.5rem;">Enterprise AI Cost Breakdown</h3>
                            <p style="color: rgba(255,255,255,0.8); font-size: 0.9rem; margin: 0;">Usage-based modeling + quality benefits + compliance</p>
                        </div>
                    </div>
                </div>

                <!-- Unlock CTA -->
                <div style="margin-top: 4rem; text-align: center; padding: 3rem; background: linear-gradient(135deg, rgba(212, 165, 116, 0.1) 0%, rgba(44, 62, 80, 0.1) 100%); border-radius: 12px;">
                    <h3 style="color: white; margin-bottom: 1rem;">Get the Full CFO-Grade Analysis</h3>
                    <p style="color: rgba(255,255,255,0.8); margin-bottom: 2rem; max-width: 600px; margin-left: auto; margin-right: auto;">
                        These premium features are available to advisory clients. Schedule a session to get your complete financial model with NPV/IRR, scenario analysis, usage-based cost modeling, and board-ready deliverables.
                    </p>
                    <a href="../index.html#contact" style="display: inline-block; padding: 1rem 2rem; background: linear-gradient(135deg, #d4a574 0%, #c19560 100%); color: white; text-decoration: none; border-radius: 8px; font-weight: 600; transition: all 0.3s;">
                        Schedule Advisory Session
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script>
        function calculateROI() {
            // Get input values
            const useCase = document.getElementById('use-case').value;
            const companySize = parseFloat(document.getElementById('company-size').value);
            const affectedEmployees = parseFloat(document.getElementById('affected-employees').value);
            const avgSalary = parseFloat(document.getElementById('average-salary').value);
            const implementationType = document.getElementById('implementation-type').value;
            // monthlyVolume removed - being redesigned for usage-based cost modeling
            const initialInvestment = parseFloat(document.getElementById('initial-investment').value);
            const monthlyCost = parseFloat(document.getElementById('monthly-cost').value);
            const trainingCost = parseFloat(document.getElementById('training-cost').value);
            let efficiencyGain = parseFloat(document.getElementById('efficiency-gain').value) / 100;
            let realizationRate = parseFloat(document.getElementById('realization-rate').value) / 100;
            let rampTime = parseFloat(document.getElementById('ramp-time').value);

            // Input validation and clamping
            efficiencyGain = Math.max(0, Math.min(1, efficiencyGain || 0));
            realizationRate = Math.max(0, Math.min(1, realizationRate || 0));
            rampTime = Math.max(1, Math.min(24, rampTime || 6));

            // Calculate monthly value with burden rate and realization rate
            const burdenRate = 1.3;  // Benefits + overhead multiplier
            const hourlyRate = (avgSalary * burdenRate) / (52 * 40);
            const monthlyHoursSaved = affectedEmployees * (40 * 4.33 * efficiencyGain);
            const peakMonthlySavings = monthlyHoursSaved * hourlyRate * realizationRate;

            // Calculate costs and savings over time
            const totalInitialCost = initialInvestment + trainingCost;
            let cumulativeValue = -totalInitialCost;
            let breakEvenMonth = 0;
            let values = [];
            let totalSavings1Year = 0;
            let totalSavings3Year = 0;

            // S-curve adoption function (logistic curve for realistic ramp-up)
            function adoptionCurve(month, midpoint, steepness = 0.6) {
                return 1 / (1 + Math.exp(-steepness * (month - midpoint)));
            }

            for (let month = 1; month <= 36; month++) {
                // S-curve ramp-up (slow start, rapid middle, plateau)
                const midpoint = rampTime / 2;
                const rampFactor = adoptionCurve(month, midpoint);
                const monthlySavings = peakMonthlySavings * rampFactor;
                const netMonthly = monthlySavings - monthlyCost;

                // Track gross savings for proper ROI calculation
                if (month <= 12) totalSavings1Year += monthlySavings;
                totalSavings3Year += monthlySavings;

                cumulativeValue += netMonthly;
                values.push(cumulativeValue);

                if (cumulativeValue > 0 && breakEvenMonth === 0) {
                    breakEvenMonth = month;
                }
            }

            // Calculate ROI percentages using proper TCO basis
            // ROI = (Total Benefits - Total Costs) / Total Costs √ó 100
            const totalCost1Year = totalInitialCost + (monthlyCost * 12);
            const totalCost3Year = totalInitialCost + (monthlyCost * 36);
            const roi1Year = (((totalSavings1Year - totalCost1Year) / totalCost1Year) * 100).toFixed(0);
            const roi3Year = (((totalSavings3Year - totalCost3Year) / totalCost3Year) * 100).toFixed(0);

            // Update display
            document.getElementById('breakeven').textContent = breakEvenMonth || 'No break-even in 36 mo';
            document.getElementById('roi-1year').textContent = roi1Year + '%';
            document.getElementById('roi-3year').textContent = roi3Year + '%';
            document.getElementById('monthly-savings').textContent = '$' + peakMonthlySavings.toFixed(0).replace(/\B(?=(\d{3})+(?!\d))/g, ',');

            // Update chart
            const maxValue = Math.max(...values, 0);
            const minValue = Math.min(...values, 0);
            const range = Math.max(maxValue - minValue, 1); // Guard against divide-by-zero when all values equal

            const updateBar = (id, index) => {
                const value = values[index];
                const height = Math.max(((value - minValue) / range) * 180, 10);
                document.getElementById(id).style.height = height + 'px';
                document.getElementById(id).style.background = value > 0 ? '#10b981' : '#ef4444';
            };

            updateBar('bar-6mo', 5);
            updateBar('bar-12mo', 11);
            updateBar('bar-18mo', 17);
            updateBar('bar-24mo', 23);
            updateBar('bar-36mo', 35);

            // Show results
            document.getElementById('results').style.display = 'block';
            document.getElementById('results').scrollIntoView({ behavior: 'smooth' });
        }
    </script>
</body>
</html>